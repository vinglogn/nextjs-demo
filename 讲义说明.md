# Next.js å…¥é—¨å­¦ä¹ è®²ä¹‰

## ğŸ“– è¯¾ç¨‹æ¦‚è¿°

æœ¬è®²ä¹‰å°†å¸¦æ‚¨æ·±å…¥äº†è§£ Next.js çš„æ ¸å¿ƒæ¦‚å¿µï¼Œé€šè¿‡ä¸€ä¸ªå®Œæ•´çš„ç”¨æˆ·ç®¡ç†ç³»ç»Ÿç¤ºä¾‹ï¼Œå­¦ä¹ å‰åç«¯äº¤äº’ã€è·¯ç”±ç³»ç»Ÿã€æ•°æ®æµç¨‹å’Œéƒ¨ç½²ç­‰å…³é”®çŸ¥è¯†ç‚¹ã€‚

## ğŸ¯ å­¦ä¹ ç›®æ ‡

1. ç†è§£ Next.js çš„ App Router æ¶æ„
2. æŒæ¡æœåŠ¡ç«¯æ¸²æŸ“å’Œå®¢æˆ·ç«¯æ¸²æŸ“çš„åŒºåˆ«
3. å­¦ä¼šåˆ›å»ºå’Œä½¿ç”¨ API è·¯ç”±
4. ç†è§£å‰åç«¯æ•°æ®äº¤äº’æµç¨‹
5. æŒæ¡é¡¹ç›®éƒ¨ç½²æ–¹æ³•

---

## ğŸ—ï¸ ç¬¬ä¸€éƒ¨åˆ†ï¼šé¡¹ç›®æ¶æ„ä¸è·¯ç”±ç³»ç»Ÿ

### 1.1 Next.js 14 App Router æ¶æ„

#### æ ¸å¿ƒæ¦‚å¿µ
- **App Router**: Next.js 13+ çš„æ–°è·¯ç”±ç³»ç»Ÿï¼ŒåŸºäºæ–‡ä»¶ç³»ç»Ÿ
- **Server Components**: é»˜è®¤åœ¨æœåŠ¡å™¨ç«¯æ¸²æŸ“çš„ç»„ä»¶
- **Client Components**: åœ¨å®¢æˆ·ç«¯è¿è¡Œçš„äº¤äº’å¼ç»„ä»¶

#### æ–‡ä»¶ç»“æ„è¯´æ˜
```
app/
â”œâ”€â”€ layout.tsx          # æ ¹å¸ƒå±€ï¼ˆæ‰€æœ‰é¡µé¢å…±äº«ï¼‰
â”œâ”€â”€ page.tsx            # é¦–é¡µ (/)
â”œâ”€â”€ users/
â”‚   â”œâ”€â”€ page.tsx        # ç”¨æˆ·åˆ—è¡¨é¡µ (/users)
â”‚   â””â”€â”€ [id]/
â”‚       â””â”€â”€ page.tsx    # ç”¨æˆ·è¯¦æƒ…é¡µ (/users/1, /users/2...)
â””â”€â”€ api/
    â””â”€â”€ users/
        â”œâ”€â”€ route.ts    # API ç«¯ç‚¹ (/api/users)
        â””â”€â”€ [id]/
            â””â”€â”€ route.ts # å•ä¸ªç”¨æˆ· API (/api/users/1)
```

#### è·¯ç”±è§„åˆ™
- `page.tsx` = é¡µé¢ç»„ä»¶
- `layout.tsx` = å¸ƒå±€ç»„ä»¶
- `route.ts` = API è·¯ç”±
- `[id]` = åŠ¨æ€è·¯ç”±å‚æ•°

### 1.2 è·¯ç”±ç±»å‹è¯¦è§£

#### é™æ€è·¯ç”±
```typescript
// app/page.tsx â†’ /
// app/about/page.tsx â†’ /about
// app/contact/page.tsx â†’ /contact
```

#### åŠ¨æ€è·¯ç”±
```typescript
// app/users/[id]/page.tsx â†’ /users/1, /users/2, /users/3...
// app/posts/[slug]/page.tsx â†’ /posts/hello-world, /posts/my-post...
```

#### åµŒå¥—è·¯ç”±
```typescript
// app/dashboard/settings/page.tsx â†’ /dashboard/settings
// app/dashboard/profile/page.tsx â†’ /dashboard/profile
```

---

## ğŸ”„ ç¬¬äºŒéƒ¨åˆ†ï¼šæ•°æ®è·å–ä¸æ¸²æŸ“ç­–ç•¥

### 2.1 æœåŠ¡ç«¯æ¸²æŸ“ (SSR)

#### ç‰¹ç‚¹
- é¡µé¢åœ¨æœåŠ¡å™¨ç«¯æ¸²æŸ“
- SEO å‹å¥½
- é¦–å±åŠ è½½å¿«
- é€‚åˆå†…å®¹å‹é¡µé¢

#### å®ç°æ–¹å¼
```typescript
// app/users/page.tsx
export default function UsersPage() {
  // æ•°æ®åœ¨æœåŠ¡å™¨ç«¯è·å–
  const users = [
    { id: 1, name: 'å¼ ä¸‰', email: 'zhangsan@example.com' },
    { id: 2, name: 'æå››', email: 'lisi@example.com' }
  ]

  return (
    <div>
      {users.map(user => (
        <div key={user.id}>{user.name}</div>
      ))}
    </div>
  )
}
```

### 2.2 é™æ€ç”Ÿæˆ (SSG)

#### ç‰¹ç‚¹
- æ„å»ºæ—¶é¢„æ¸²æŸ“é¡µé¢
- æ€§èƒ½æœ€ä½³
- é€‚åˆå†…å®¹ä¸ç»å¸¸å˜åŒ–çš„é¡µé¢

#### å®ç°æ–¹å¼
```typescript
// app/users/[id]/page.tsx
export async function generateStaticParams() {
  return [
    { id: '1' },
    { id: '2' },
    { id: '3' }
  ]
}

export default function UserPage({ params }: { params: { id: string } }) {
  // æ ¹æ® params.id è·å–ç”¨æˆ·æ•°æ®
  return <div>ç”¨æˆ· {params.id}</div>
}
```

### 2.3 å®¢æˆ·ç«¯æ•°æ®è·å–

#### ç‰¹ç‚¹
- é¡µé¢åœ¨å®¢æˆ·ç«¯æ¸²æŸ“
- é€‚åˆäº¤äº’æ€§å¼ºçš„é¡µé¢
- éœ€è¦ç”¨æˆ·äº¤äº’åè·å–æ•°æ®

#### å®ç°æ–¹å¼
```typescript
'use client'

import { useState, useEffect } from 'react'

export default function ApiDemoPage() {
  const [users, setUsers] = useState([])
  const [loading, setLoading] = useState(false)

  useEffect(() => {
    const fetchUsers = async () => {
      setLoading(true)
      const response = await fetch('/api/users')
      const data = await response.json()
      setUsers(data.data)
      setLoading(false)
    }

    fetchUsers()
  }, [])

  return (
    <div>
      {loading ? 'åŠ è½½ä¸­...' : (
        users.map(user => <div key={user.id}>{user.name}</div>)
      )}
    </div>
  )
}
```

---

## ğŸ”Œ ç¬¬ä¸‰éƒ¨åˆ†ï¼šAPI è·¯ç”±ä¸åç«¯å¼€å‘

### 3.1 API è·¯ç”±åŸºç¡€

#### æ–‡ä»¶ä½ç½®
- `app/api/route.ts` â†’ `/api`
- `app/api/users/route.ts` â†’ `/api/users`
- `app/api/users/[id]/route.ts` â†’ `/api/users/1`

#### HTTP æ–¹æ³•å¤„ç†
```typescript
// app/api/users/route.ts
import { NextRequest, NextResponse } from 'next/server'

// GET è¯·æ±‚
export async function GET() {
  return NextResponse.json({ users: [] })
}

// POST è¯·æ±‚
export async function POST(request: NextRequest) {
  const body = await request.json()
  return NextResponse.json({ message: 'åˆ›å»ºæˆåŠŸ' })
}
```

### 3.2 å®Œæ•´çš„ CRUD API ç¤ºä¾‹

#### è·å–ç”¨æˆ·åˆ—è¡¨ (GET)
```typescript
export async function GET() {
  try {
    const users = [
      { id: 1, name: 'å¼ ä¸‰', email: 'zhangsan@example.com' }
    ]
    
    return NextResponse.json({
      success: true,
      data: users,
      message: 'è·å–æˆåŠŸ'
    })
  } catch (error) {
    return NextResponse.json(
      { success: false, message: 'è·å–å¤±è´¥' },
      { status: 500 }
    )
  }
}
```

#### åˆ›å»ºç”¨æˆ· (POST)
```typescript
export async function POST(request: NextRequest) {
  try {
    const body = await request.json()
    const { name, email } = body

    // éªŒè¯æ•°æ®
    if (!name || !email) {
      return NextResponse.json(
        { success: false, message: 'ç¼ºå°‘å¿…å¡«å­—æ®µ' },
        { status: 400 }
      )
    }

    // åˆ›å»ºç”¨æˆ·é€»è¾‘
    const newUser = { id: Date.now(), name, email }

    return NextResponse.json({
      success: true,
      data: newUser,
      message: 'åˆ›å»ºæˆåŠŸ'
    }, { status: 201 })
  } catch (error) {
    return NextResponse.json(
      { success: false, message: 'åˆ›å»ºå¤±è´¥' },
      { status: 500 }
    )
  }
}
```

#### æ›´æ–°ç”¨æˆ· (PUT)
```typescript
export async function PUT(
  request: NextRequest,
  { params }: { params: { id: string } }
) {
  try {
    const id = parseInt(params.id)
    const body = await request.json()
    
    // æ›´æ–°ç”¨æˆ·é€»è¾‘
    return NextResponse.json({
      success: true,
      message: 'æ›´æ–°æˆåŠŸ'
    })
  } catch (error) {
    return NextResponse.json(
      { success: false, message: 'æ›´æ–°å¤±è´¥' },
      { status: 500 }
    )
  }
}
```

#### åˆ é™¤ç”¨æˆ· (DELETE)
```typescript
export async function DELETE(
  request: NextRequest,
  { params }: { params: { id: string } }
) {
  try {
    const id = parseInt(params.id)
    
    // åˆ é™¤ç”¨æˆ·é€»è¾‘
    return NextResponse.json({
      success: true,
      message: 'åˆ é™¤æˆåŠŸ'
    })
  } catch (error) {
    return NextResponse.json(
      { success: false, message: 'åˆ é™¤å¤±è´¥' },
      { status: 500 }
    )
  }
}
```

---

## ğŸ”„ ç¬¬å››éƒ¨åˆ†ï¼šå‰åç«¯äº¤äº’æµç¨‹

### 4.1 å®Œæ•´çš„æ•°æ®äº¤äº’æµç¨‹

#### 1. ç”¨æˆ·è®¿é—®é¡µé¢
```
ç”¨æˆ· â†’ æµè§ˆå™¨ â†’ Next.js æœåŠ¡å™¨
```

#### 2. æœåŠ¡ç«¯æ¸²æŸ“
```
Next.js æœåŠ¡å™¨ â†’ æ¸²æŸ“é¡µé¢ â†’ è¿”å› HTML
```

#### 3. å®¢æˆ·ç«¯äº¤äº’
```
ç”¨æˆ·ç‚¹å‡»æŒ‰é’® â†’ å®¢æˆ·ç«¯ JavaScript â†’ è°ƒç”¨ API
```

#### 4. API å¤„ç†
```
API è·¯ç”± â†’ å¤„ç†è¯·æ±‚ â†’ è¿”å›æ•°æ®
```

#### 5. æ›´æ–°ç•Œé¢
```
å®¢æˆ·ç«¯ â†’ æ¥æ”¶æ•°æ® â†’ æ›´æ–° DOM
```

### 4.2 å®é™…ä»£ç ç¤ºä¾‹

#### å‰ç«¯ç»„ä»¶
```typescript
'use client'

export default function UserForm() {
  const [formData, setFormData] = useState({
    name: '',
    email: ''
  })

  const handleSubmit = async (e) => {
    e.preventDefault()
    
    try {
      const response = await fetch('/api/users', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(formData)
      })
      
      const result = await response.json()
      
      if (result.success) {
        alert('åˆ›å»ºæˆåŠŸï¼')
        setFormData({ name: '', email: '' })
      } else {
        alert(result.message)
      }
    } catch (error) {
      alert('åˆ›å»ºå¤±è´¥')
    }
  }

  return (
    <form onSubmit={handleSubmit}>
      <input
        value={formData.name}
        onChange={(e) => setFormData({...formData, name: e.target.value})}
        placeholder="å§“å"
      />
      <input
        value={formData.email}
        onChange={(e) => setFormData({...formData, email: e.target.value})}
        placeholder="é‚®ç®±"
      />
      <button type="submit">åˆ›å»ºç”¨æˆ·</button>
    </form>
  )
}
```

#### åç«¯ API
```typescript
export async function POST(request: NextRequest) {
  try {
    const body = await request.json()
    const { name, email } = body

    // æ•°æ®éªŒè¯
    if (!name || !email) {
      return NextResponse.json(
        { success: false, message: 'ç¼ºå°‘å¿…å¡«å­—æ®µ' },
        { status: 400 }
      )
    }

    // ä¸šåŠ¡é€»è¾‘å¤„ç†
    const newUser = {
      id: Date.now(),
      name,
      email,
      createdAt: new Date()
    }

    // è¿”å›ç»“æœ
    return NextResponse.json({
      success: true,
      data: newUser,
      message: 'ç”¨æˆ·åˆ›å»ºæˆåŠŸ'
    }, { status: 201 })
  } catch (error) {
    return NextResponse.json(
      { success: false, message: 'æœåŠ¡å™¨é”™è¯¯' },
      { status: 500 }
    )
  }
}
```

---

## ğŸš€ ç¬¬äº”éƒ¨åˆ†ï¼šéƒ¨ç½²ä¸ä¸Šçº¿

### 5.1 æœ¬åœ°æ„å»º

#### 1. å®‰è£…ä¾èµ–
```bash
npm install
```

#### 2. æ„å»ºé¡¹ç›®
```bash
npm run build
```

#### 3. å¯åŠ¨ç”Ÿäº§æœåŠ¡å™¨
```bash
npm start
```

### 5.2 Vercel éƒ¨ç½² (æ¨è)

#### 1. å‡†å¤‡ä»£ç 
```bash
git add .
git commit -m "å‡†å¤‡éƒ¨ç½²"
git push origin main
```

#### 2. è¿æ¥ Vercel
1. è®¿é—® [vercel.com](https://vercel.com)
2. ä½¿ç”¨ GitHub è´¦å·ç™»å½•
3. ç‚¹å‡» "New Project"
4. é€‰æ‹©ä½ çš„ä»“åº“
5. ç‚¹å‡» "Deploy"

#### 3. è‡ªåŠ¨éƒ¨ç½²
- Vercel ä¼šè‡ªåŠ¨æ£€æµ‹ Next.js é¡¹ç›®
- è‡ªåŠ¨è¿è¡Œ `npm run build`
- éƒ¨ç½²åˆ°å…¨çƒ CDN

### 5.3 å…¶ä»–éƒ¨ç½²å¹³å°

#### Netlify
```bash
# æ„å»ºå‘½ä»¤
npm run build

# å‘å¸ƒç›®å½•
.next
```

#### ä¼ ç»ŸæœåŠ¡å™¨
```bash
# 1. æ„å»ºé¡¹ç›®
npm run build

# 2. å¤åˆ¶æ–‡ä»¶åˆ°æœåŠ¡å™¨
scp -r .next user@server:/path/to/app

# 3. å®‰è£…ä¾èµ–
npm install --production

# 4. å¯åŠ¨æœåŠ¡
npm start
```

---

## ğŸ“Š ç¬¬å…­éƒ¨åˆ†ï¼šæ€§èƒ½ä¼˜åŒ–

### 6.1 ä»£ç åˆ†å‰²
- Next.js è‡ªåŠ¨è¿›è¡Œä»£ç åˆ†å‰²
- æ¯ä¸ªé¡µé¢ç‹¬ç«‹æ‰“åŒ…
- æŒ‰éœ€åŠ è½½ç»„ä»¶

### 6.2 å›¾ç‰‡ä¼˜åŒ–
```typescript
import Image from 'next/image'

export default function OptimizedImage() {
  return (
    <Image
      src="/avatar.jpg"
      alt="ç”¨æˆ·å¤´åƒ"
      width={100}
      height={100}
      priority
    />
  )
}
```

### 6.3 ç¼“å­˜ç­–ç•¥
```typescript
// é™æ€é¡µé¢ç¼“å­˜
export const revalidate = 3600 // 1å°æ—¶

// åŠ¨æ€æ•°æ®ç¼“å­˜
const data = await fetch('https://api.example.com/data', {
  next: { revalidate: 60 } // 1åˆ†é’Ÿ
})
```

---

## ğŸ”§ ç¬¬ä¸ƒéƒ¨åˆ†ï¼šå¼€å‘å·¥å…·ä¸è°ƒè¯•

### 7.1 å¼€å‘æœåŠ¡å™¨
```bash
npm run dev
# è®¿é—® http://localhost:3000
```

### 7.2 ä»£ç æ£€æŸ¥
```bash
npm run lint
```

### 7.3 ç±»å‹æ£€æŸ¥
```bash
npx tsc --noEmit
```

### 7.4 è°ƒè¯•æŠ€å·§

#### 1. æœåŠ¡ç«¯è°ƒè¯•
```typescript
console.log('æœåŠ¡ç«¯æ—¥å¿—')
```

#### 2. å®¢æˆ·ç«¯è°ƒè¯•
```typescript
'use client'
console.log('å®¢æˆ·ç«¯æ—¥å¿—')
```

#### 3. API è°ƒè¯•
```typescript
export async function GET() {
  console.log('API è¢«è°ƒç”¨')
  return NextResponse.json({ message: 'Hello' })
}
```

---

## ğŸ“š ç¬¬å…«éƒ¨åˆ†ï¼šæœ€ä½³å®è·µ

### 8.1 æ–‡ä»¶ç»„ç»‡
```
app/
â”œâ”€â”€ components/          # å¯å¤ç”¨ç»„ä»¶
â”œâ”€â”€ lib/                # å·¥å…·å‡½æ•°
â”œâ”€â”€ types/              # TypeScript ç±»å‹
â”œâ”€â”€ hooks/              # è‡ªå®šä¹‰ Hooks
â””â”€â”€ utils/              # å·¥å…·å‡½æ•°
```

### 8.2 é”™è¯¯å¤„ç†
```typescript
// å…¨å±€é”™è¯¯å¤„ç†
export default function GlobalError({
  error,
  reset,
}: {
  error: Error & { digest?: string }
  reset: () => void
}) {
  return (
    <html>
      <body>
        <h2>å‡ºé”™äº†ï¼</h2>
        <button onClick={() => reset()}>é‡è¯•</button>
      </body>
    </html>
  )
}
```

### 8.3 ç¯å¢ƒå˜é‡
```bash
# .env.local
DATABASE_URL=postgresql://...
API_KEY=your-api-key
```

```typescript
// ä½¿ç”¨ç¯å¢ƒå˜é‡
const apiKey = process.env.API_KEY
const publicUrl = process.env.NEXT_PUBLIC_URL
```

---

## ğŸ¯ æ€»ç»“

é€šè¿‡è¿™ä¸ªå®Œæ•´çš„ Next.js ç¤ºä¾‹é¡¹ç›®ï¼Œæˆ‘ä»¬å­¦ä¹ äº†ï¼š

1. **è·¯ç”±ç³»ç»Ÿ**: App Router çš„æ–‡ä»¶ç³»ç»Ÿè·¯ç”±
2. **æ•°æ®è·å–**: SSRã€SSGã€å®¢æˆ·ç«¯æ•°æ®è·å–
3. **API å¼€å‘**: åˆ›å»º RESTful API æ¥å£
4. **å‰åç«¯äº¤äº’**: å®Œæ•´çš„æ•°æ®æµå¤„ç†
5. **éƒ¨ç½²ä¸Šçº¿**: å¤šç§éƒ¨ç½²æ–¹æ¡ˆ
6. **æ€§èƒ½ä¼˜åŒ–**: ä»£ç åˆ†å‰²ã€ç¼“å­˜ç­–ç•¥
7. **å¼€å‘å·¥å…·**: è°ƒè¯•å’Œå¼€å‘æŠ€å·§
8. **æœ€ä½³å®è·µ**: é¡¹ç›®ç»„ç»‡å’Œé”™è¯¯å¤„ç†

è¿™ä¸ªé¡¹ç›®ä¸ºå­¦ä¹  Next.js æä¾›äº†å®Œæ•´çš„å®è·µåŸºç¡€ï¼Œæ¶µç›–äº†ç°ä»£ Web å¼€å‘çš„æ ¸å¿ƒæ¦‚å¿µå’ŒæŠ€æœ¯æ ˆã€‚

---

## ğŸ“– å»¶ä¼¸å­¦ä¹ 

- [Next.js å®˜æ–¹æ–‡æ¡£](https://nextjs.org/docs)
- [React å®˜æ–¹æ–‡æ¡£](https://react.dev)
- [TypeScript å®˜æ–¹æ–‡æ¡£](https://www.typescriptlang.org/docs)
- [Tailwind CSS æ–‡æ¡£](https://tailwindcss.com/docs)

ç¥æ‚¨å­¦ä¹ æ„‰å¿«ï¼ğŸš€ 